document.querySelectorAll(".audio-btn").forEach(btn=>{

  const audio = btn.previousElementSibling;
  const icon = btn.querySelector(".audio-icon path");
  const circle = btn.querySelector(".audio-progress circle");

  const circumference = 157;
  circle.style.strokeDasharray = circumference;
  circle.style.strokeDashoffset = circumference;

  btn.onclick = () => {

    // Stop others
    document.querySelectorAll("audio").forEach(a=>{
      if(a !== audio){
        a.pause();
        a.currentTime = 0;
      }
    });

    document.querySelectorAll(".audio-icon path").forEach(i=>{
      i.setAttribute("d","M3 9v6h4l5 5V4L7 9z");
    });

    document.querySelectorAll(".audio-progress circle").forEach(c=>{
      c.style.strokeDashoffset = circumference;
    });

    if(audio.paused){

      audio.play();
      icon.setAttribute("d","M6 6h4v12H6zm8 0h4v12h-4z");

    } else {

      audio.pause();
      audio.currentTime = 0;
      icon.setAttribute("d","M3 9v6h4l5 5V4L7 9z");
      circle.style.strokeDashoffset = circumference;

    }

    audio.ontimeupdate = () => {

      const progress = audio.currentTime / audio.duration;
      circle.style.strokeDashoffset =
        circumference - (progress * circumference);

    };

    audio.onended = () => {

      icon.setAttribute("d","M3 9v6h4l5 5V4L7 9z");
      circle.style.strokeDashoffset = circumference;

    };

  };

});
