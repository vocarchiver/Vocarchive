<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Vocarchive - Vocaloid Style Cards</title>
<style>
body { font-family:"Segoe UI", Tahoma, Geneva, Verdana, sans-serif; background:#f0f2f5; padding:20px; color:#333; }
h1 { text-align:center; margin-bottom:30px; font-size:2rem; color:#222; }

/* GRID */
.grid {
  display:flex;
  flex-wrap:wrap;
  gap:20px;
  justify-content:center;
}

/* TARJETA */
.card {
  width:411px;
  background:#fff;
  border-radius:18px;
  overflow:hidden;
  box-shadow:0 8px 20px rgba(0,0,0,0.1);
  transition:transform 0.2s, box-shadow 0.2s;
  display:flex;
  flex-direction:column;
}
.card:hover { transform: translateY(-5px); box-shadow:0 12px 25px rgba(0,0,0,0.15); }

/* SECCIÓN SUPERIOR - IMAGEN */
.card-image-section {
  width:411px;
  height:290px;
  background:#f5f5f5;
  display:flex;
  justify-content:center;
  align-items:center;
  transition: all 0.3s ease;
  position:relative;
}
.card:hover .card-image-section {
  height:260px; /* se reduce el fondo al pasar el mouse */
}

/* IMAGEN */
.card-image-section img {
  width:250px;
  height:250px;
  object-fit:cover;
  z-index:1;
  border-radius:8px;
}

/* Badge NEW */
.badge {
  position:absolute;
  top:10px;
  left:10px;
  background:#e74c3c;
  color:white;
  font-size:12px;
  padding:3px 8px;
  border-radius:12px;
  font-weight:bold;
  z-index:2;
}

/* SECCIÓN INFERIOR - CONTENIDO */
.card-content {
  padding:16px;
  display:flex;
  flex-direction:column;
  align-items:flex-start;
}
.card-content h2 { font-size:1.2rem; margin-bottom:5px; }
.card-content p { font-size:0.95rem; margin-bottom:10px; color:#555; }

/* TAGS */
.tags {
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  margin-bottom:12px;
}
.tag {
  font-size:11px;
  background:#eee;
  padding:4px 8px;
  border-radius:12px;
}

/* BOTÓN */
.button {
  display:inline-block;
  padding:10px 16px;
  border-radius:12px;
  background:#222;
  color:white;
  text-decoration:none;
  font-weight:bold;
  transition:background 0.2s;
  text-align:center;
  width:100%;
}
.button:hover { background:#444; }

/* BUSCADOR */
.search input{
  width:100%;
  max-width:400px;
  padding:10px;
  font-size:16px;
  margin:0 auto 20px auto;
  display:block;
}
</style>
</head>
<body>

<h1>Vocarchive</h1>

<div class="search">
  <input type="text" id="searchInput" placeholder="Buscar voicebank...">
</div>

<div class="grid" id="cards"></div>

<script>
// URL de tu CSV publicado desde Google Sheets
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ7kkYSZzuZWqbIHJirQ9gqY5FEI5J6varhsYCWdftjXD4PfU8ziayU99tuiE9hOvBnssbBW-XEq0J9/pub?output=csv";
const NEW_DAYS = 14; // días para badge NEW

let voicebanks = [];

/* CSV PARSER */
function parseCSV(text){
  const rows = [];
  let row=[], cell="", insideQuotes=false;
  for(let i=0;i<text.length;i++){
    const c=text[i];
    if(c=='"') insideQuotes=!insideQuotes;
    else if(c==','&&!insideQuotes){row.push(cell);cell="";}
    else if((c=='\n'||c=='\r')&&!insideQuotes){if(cell||row.length){row.push(cell);rows.push(row);row=[];cell="";}} 
    else{cell+=c;}
  }
  if(cell||row.length){row.push(cell);rows.push(row);}
  return rows;
}

/* CARGAR SHEETS */
fetch(SHEET_URL).then(r=>r.text()).then(csv=>{
  const rows=parseCSV(csv);
  rows.shift(); // eliminar encabezados

  voicebanks=rows.map(r=>{
    const releaseDate=new Date(r[2]);
    const isNew=(new Date()-releaseDate)/(1000*60*60*24)<=NEW_DAYS;
    const tags=[r[4], r[5], ...r[6].split(",").map(s=>s.trim()), r[7], r[8], r[9]].filter(t=>t);
    return {
      folio:r[1],
      release:r[2],
      name:r[3],
      type:r[4]+" Voicebank",
      image:r[13],
      audio:r[14],
      url:r[12],
      tags:tags,
      isNew:isNew
    };
  }).filter(v=>v.name);

  update();
});

/* FILTRAR Y ACTUALIZAR */
function update(){
  const search=document.getElementById("searchInput").value.toLowerCase();
  const filtered=voicebanks.filter(v=>v.name.toLowerCase().includes(search));
  filtered.sort((a,b)=>new Date(b.release)-new Date(a.release));
  renderCards(filtered);
}

/* RENDER TARJETAS */
function renderCards(list){
  document.getElementById("cards").innerHTML=list.map(v=>`
    <div class="card">
      <div class="card-image-section">
        <img src="${v.image}" alt="${v.name}">
        ${v.isNew?'<span class="badge">NEW</span>':''}
      </div>
      <div class="card-content">
        <h2>${v.name}</h2>
        <p>${v.type}</p>
        <div class="tags">${v.tags.map(tag=>`<span class="tag">${tag}</span>`).join("")}</div>
        <a class="button" href="${v.url}" target="_blank">See product details</a>
      </div>
    </div>
  `).join("");
}

document.getElementById("searchInput").addEventListener("input", update);
</script>

</body>
</html>
